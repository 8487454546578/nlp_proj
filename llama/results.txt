(pytorch) bead@amax:/data/bead/NLP/pro/nlp_proj$ PYTHONPATH=. python /data/bead/NLP/pro/nlp_proj/llama/scripts/train_reward_base_for_ppo.py
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:31<00:00,  5.34it/s]

Epoch 1, Loss: 0.6789, Val Acc: 0.6823
Saved best model at epoch 1 with acc 0.6823
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.42it/s]

Epoch 2, Loss: 0.6556, Val Acc: 0.7090
Saved best model at epoch 2 with acc 0.7090
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 3, Loss: 0.6411, Val Acc: 0.7258
Saved best model at epoch 3 with acc 0.7258
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 4, Loss: 0.6310, Val Acc: 0.7324
Saved best model at epoch 4 with acc 0.7324
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 5, Loss: 0.6235, Val Acc: 0.7258
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.42it/s]

Epoch 6, Loss: 0.6176, Val Acc: 0.7425
Saved best model at epoch 6 with acc 0.7425
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 7, Loss: 0.6128, Val Acc: 0.7391
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 8, Loss: 0.6087, Val Acc: 0.7458
Saved best model at epoch 8 with acc 0.7458
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 9, Loss: 0.6053, Val Acc: 0.7458
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 10, Loss: 0.6023, Val Acc: 0.7525
Saved best model at epoch 10 with acc 0.7525
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 11, Loss: 0.5998, Val Acc: 0.7492
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 12, Loss: 0.5975, Val Acc: 0.7525
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 13, Loss: 0.5954, Val Acc: 0.7525
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [07:36<00:00,  2.72s/it]

Epoch 14, Loss: 0.5936, Val Acc: 0.7559
Saved best model at epoch 14 with acc 0.7559
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.43it/s]

Epoch 15, Loss: 0.5919, Val Acc: 0.7592
Saved best model at epoch 15 with acc 0.7592
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:31<00:00,  5.41it/s]

Epoch 16, Loss: 0.5904, Val Acc: 0.7525
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 17, Loss: 0.5890, Val Acc: 0.7559
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 18, Loss: 0.5877, Val Acc: 0.7559
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 19, Loss: 0.5864, Val Acc: 0.7592
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 20, Loss: 0.5853, Val Acc: 0.7592
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 21, Loss: 0.5842, Val Acc: 0.7592
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 22, Loss: 0.5832, Val Acc: 0.7592
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.45it/s]

Epoch 23, Loss: 0.5823, Val Acc: 0.7559
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.45it/s]

Epoch 24, Loss: 0.5814, Val Acc: 0.7525
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 25, Loss: 0.5805, Val Acc: 0.7525
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 26, Loss: 0.5797, Val Acc: 0.7559
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 27, Loss: 0.5789, Val Acc: 0.7559
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.46it/s]

Epoch 28, Loss: 0.5782, Val Acc: 0.7559
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.46it/s]

Epoch 29, Loss: 0.5775, Val Acc: 0.7525
Epoch 30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:30<00:00,  5.44it/s]

Epoch 30, Loss: 0.5768, Val Acc: 0.7525

Evaluating best model on test set...
Test Accuracy: 0.6753


(pytorch) bead@amax:/data/bead/NLP/pro/nlp_proj$ PYTHONPATH=. python /data/bead/NLP/pro/nlp_proj/llama/scripts/train_reward_base_for_eval.py
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.86it/s]

Epoch 1, Loss: 0.5929, Val Acc: 0.7358
Saved best model at epoch 1 with acc 0.7358
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.92it/s]

Epoch 2, Loss: 0.5442, Val Acc: 0.7860
Saved best model at epoch 2 with acc 0.7860
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:35<00:00,  4.79it/s]

Epoch 3, Loss: 0.5100, Val Acc: 0.7692
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 4, Loss: 0.4843, Val Acc: 0.7759
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 5, Loss: 0.4670, Val Acc: 0.7692
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.89it/s]

Epoch 6, Loss: 0.4495, Val Acc: 0.7726
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.91it/s]

Epoch 7, Loss: 0.4365, Val Acc: 0.7692
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.89it/s]

Epoch 8, Loss: 0.4203, Val Acc: 0.7793
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 9, Loss: 0.4090, Val Acc: 0.7793
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 10, Loss: 0.3987, Val Acc: 0.7926
Saved best model at epoch 10 with acc 0.7926
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.89it/s]

Epoch 11, Loss: 0.3912, Val Acc: 0.7860
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 12, Loss: 0.3836, Val Acc: 0.7993
Saved best model at epoch 12 with acc 0.7993
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:35<00:00,  4.79it/s]

Epoch 13, Loss: 0.3780, Val Acc: 0.7592
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 14, Loss: 0.3757, Val Acc: 0.7592
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 15, Loss: 0.3715, Val Acc: 0.7592
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 16, Loss: 0.3711, Val Acc: 0.7625
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 17, Loss: 0.3679, Val Acc: 0.7793
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 18, Loss: 0.3656, Val Acc: 0.7726
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 19, Loss: 0.3631, Val Acc: 0.7893
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 20, Loss: 0.3605, Val Acc: 0.7759
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.88it/s]

Epoch 21, Loss: 0.3607, Val Acc: 0.7893
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 22, Loss: 0.3609, Val Acc: 0.7525
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 23, Loss: 0.3599, Val Acc: 0.7525
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 24, Loss: 0.3603, Val Acc: 0.7793
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 25, Loss: 0.3572, Val Acc: 0.7759
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 26, Loss: 0.3570, Val Acc: 0.7692
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 27, Loss: 0.3550, Val Acc: 0.7592
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 28, Loss: 0.3555, Val Acc: 0.7625
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 29, Loss: 0.3539, Val Acc: 0.7592
Epoch 30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 168/168 [00:34<00:00,  4.93it/s]

Epoch 30, Loss: 0.3578, Val Acc: 0.7425

Evaluating best model on test set...
Test Accuracy: 0.7874